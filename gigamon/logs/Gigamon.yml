id: gigamon

facets:
  - facetType: list
    groups:
      - gigamon
    name: dns_host
    path: dns_host
    source: log
    type: string
  - facetType: list
    groups:
      - gigamon
    name: dns_name
    path: dns_name
    source: log
    type: string
  - facetType: list
    groups:
      - gigamon
    name: service
    path: service
    source: log
    type: string
pipeline:
  type: pipeline
  name: Gigamon
  enabled: true
  filter:
    query: "source:gigamon"
  processors:
    - type: url-parser
      name: URL Processor
      enabled: true
      sources:
        - http.url
      target: http.url_details
      normalizeEndingSlashes: false
    - type: user-agent-parser
      name: Useragent processor
      enabled: true
      sources:
        - http.useragent
      target: http.useragent_details
      encoded: false
      combineVersionDetails: false
    - type: geo-ip-parser
      name: Network client
      enabled: true
      sources:
        - network.client.ip
      target: network.client.geoip
      ip_processing_behavior: do-nothing
    - type: service-remapper
      name: service processor
      enabled: true
      sources:
        - gigamon
    - type: attribute-remapper
      name: remapping app name
      enabled: true
      sources:
        - app_name
      sourceType: attribute
      target: syslog.appname
      targetType: attribute
      preserveSource: false
      overrideOnConflict: true
