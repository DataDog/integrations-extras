id: "appomni-appomni"
tests:
 -
  sample: |-
    {
      "@timestamp" : "2025-01-23T21:24:40.428Z",
      "appomni" : {
        "service" : {
          "account_id" : "25",
          "name" : "AppOmni",
          "id" : 0,
          "type" : "appomni",
          "slug" : "appomni"
        },
        "organization" : {
          "id" : 25
        },
        "event" : {
          "ingestion_time" : "2025-01-23T21:24:40.482Z",
          "collected_time" : "2025-01-23T21:24:40.445Z",
          "id" : "61820277-71aa-56b5-b4ee-14aedf362753",
          "dataset" : "ao_auditlogs",
          "enrichments" : [ "ao_identity", "ipinfo", "spur" ]
        }
      },
      "related" : {
        "ip" : [ "69.10.173.18" ],
        "user" : [ "tim+bdemopingdom@appomni.com" ]
      },
      "source" : {
        "ip" : "69.10.173.18",
        "host" : {
          "type" : "desktop"
        }
      },
      "event" : {
        "ingested" : "2025-01-23T21:24:40.482Z",
        "code" : "user_login",
        "original" : "{\"action_at\":\"2025-01-23T21:24:40.428881+00:00\",\"action_data\":{\"md_kind\":\"core.aoaudit.auditdata\",\"md_version\":1,\"user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36\",\"user_ip\":\"69.10.173.18\",\"user_username\":\"tim+bdemopingdom@appomni.com\"},\"action_type\":\"user_login\",\"log_id\":\"3f901a57-9abb-453a-a14b-03d74e78fce0\",\"org_id\":25,\"user_id\":8405}",
        "created" : "2025-01-23T21:24:40.445Z",
        "kind" : "event",
        "module" : "appomni",
        "action" : "login_user",
        "id" : "3f901a57-9abb-453a-a14b-03d74e78fce0",
        "category" : [ "authentication" ],
        "type" : [ "access" ],
        "dataset" : "ao_auditlogs",
        "outcome" : "success"
      },
      "user" : {
        "name" : "tim+bdemopingdom@appomni.com",
        "id" : "8405",
        "target" : {
          "name" : "tim+bdemopingdom@appomni.com",
          "id" : "8405"
        }
      },
      "version" : "2.0.0",
      "user_agent" : {
        "original" : "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36",
        "os" : {
          "kernel" : "10.0",
          "name" : "windows",
          "type" : "windows"
        },
        "name" : "Chrome",
        "version" : "131.0.0.0"
      }
    }
  result:
    custom:
      '@timestamp': "2025-01-23T21:24:40.428Z"
      appomni:
        event:
          collected_time: "2025-01-23T21:24:40.445Z"
          dataset: "ao_auditlogs"
          enrichments:
           - "ao_identity"
           - "ipinfo"
           - "spur"
          id: "61820277-71aa-56b5-b4ee-14aedf362753"
          ingestion_time: "2025-01-23T21:24:40.482Z"
        organization:
          id: 25
        service:
          account_id: "25"
          id: 0
          name: "AppOmni"
          slug: "appomni"
          type: "appomni"
      event:
        action: "login_user"
        category:
         - "authentication"
        code: "user_login"
        created: "2025-01-23T21:24:40.445Z"
        dataset: "ao_auditlogs"
        id: "3f901a57-9abb-453a-a14b-03d74e78fce0"
        ingested: "2025-01-23T21:24:40.482Z"
        kind: "event"
        module: "appomni"
        original: "{\"action_at\":\"2025-01-23T21:24:40.428881+00:00\",\"action_data\":{\"md_kind\":\"core.aoaudit.auditdata\",\"md_version\":1,\"user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36\",\"user_ip\":\"69.10.173.18\",\"user_username\":\"tim+bdemopingdom@appomni.com\"},\"action_type\":\"user_login\",\"log_id\":\"3f901a57-9abb-453a-a14b-03d74e78fce0\",\"org_id\":25,\"user_id\":8405}"
        outcome: "success"
        type:
         - "access"
      related:
        ip:
         - "69.10.173.18"
        user:
         - "tim+bdemopingdom@appomni.com"
      source:
        host:
          type: "desktop"
        ip: "69.10.173.18"
      user:
        id: "8405"
        name: "tim+bdemopingdom@appomni.com"
        target:
          id: "8405"
          name: "tim+bdemopingdom@appomni.com"
      user_agent:
        name: "Chrome"
        original: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"
        os:
          kernel: "10.0"
          name: "windows"
          type: "windows"
        version: "131.0.0.0"
      version: "2.0.0"
    message: |-
      {
        "@timestamp" : "2025-01-23T21:24:40.428Z",
        "appomni" : {
          "service" : {
            "account_id" : "25",
            "name" : "AppOmni",
            "id" : 0,
            "type" : "appomni",
            "slug" : "appomni"
          },
          "organization" : {
            "id" : 25
          },
          "event" : {
            "ingestion_time" : "2025-01-23T21:24:40.482Z",
            "collected_time" : "2025-01-23T21:24:40.445Z",
            "id" : "61820277-71aa-56b5-b4ee-14aedf362753",
            "dataset" : "ao_auditlogs",
            "enrichments" : [ "ao_identity", "ipinfo", "spur" ]
          }
        },
        "related" : {
          "ip" : [ "69.10.173.18" ],
          "user" : [ "tim+bdemopingdom@appomni.com" ]
        },
        "source" : {
          "ip" : "69.10.173.18",
          "host" : {
            "type" : "desktop"
          }
        },
        "event" : {
          "ingested" : "2025-01-23T21:24:40.482Z",
          "code" : "user_login",
          "original" : "{\"action_at\":\"2025-01-23T21:24:40.428881+00:00\",\"action_data\":{\"md_kind\":\"core.aoaudit.auditdata\",\"md_version\":1,\"user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36\",\"user_ip\":\"69.10.173.18\",\"user_username\":\"tim+bdemopingdom@appomni.com\"},\"action_type\":\"user_login\",\"log_id\":\"3f901a57-9abb-453a-a14b-03d74e78fce0\",\"org_id\":25,\"user_id\":8405}",
          "created" : "2025-01-23T21:24:40.445Z",
          "kind" : "event",
          "module" : "appomni",
          "action" : "login_user",
          "id" : "3f901a57-9abb-453a-a14b-03d74e78fce0",
          "category" : [ "authentication" ],
          "type" : [ "access" ],
          "dataset" : "ao_auditlogs",
          "outcome" : "success"
        },
        "user" : {
          "name" : "tim+bdemopingdom@appomni.com",
          "id" : "8405",
          "target" : {
            "name" : "tim+bdemopingdom@appomni.com",
            "id" : "8405"
          }
        },
        "version" : "2.0.0",
        "user_agent" : {
          "original" : "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36",
          "os" : {
            "kernel" : "10.0",
            "name" : "windows",
            "type" : "windows"
          },
          "name" : "Chrome",
          "version" : "131.0.0.0"
        }
      }
    tags:
     - "source:LOGS_SOURCE"