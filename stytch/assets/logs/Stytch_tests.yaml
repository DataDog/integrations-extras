id: "stytch"
tests:
  - sample: |-
      {
          "ddsource": "stytch",
          "ddtags": "service:stytch.auth,stytch-env:prod",
          "verdict_action": "ALLOW",
          "ip_geo_region": "California",
          "visitor_id": "visitor-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "visitor_fingerprint": "visitor-fingerprint-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "project_name": "Stytch",
          "network_fingerprint": "network-fingerprint-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "external_metadata_organization_id": "",
          "detected_device_type": "INTEL_64BIT_LINUX_CHROME",
          "asn_name": "Some ASN Name",
          "browser_id": "browser-id-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "oauth_config_id": "oauth-config-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "project_id": "project-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "asn_network": "0.0.0.0/22",
          "ip_geo_country": "US",
          "action": "B2BOAuthDiscoveryAuthenticate",
          "oauth_provider": "Google",
          "verdict_reasons": "",
          "_timestamp": 1752177801810000,
          "user_agent": [
          	"Stytch.js Javascript SDK/v5.23.4"
          ],
          "external_metadata_external_id": "",
          "external_metadata_user_action": "SDKB2BOAuthDiscoveryAuthenticate",
          "browser_user_agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
          "timestamp": 1752177801810,
          "severity": "info",
          "session_jwt_hash": "",
          "hardware_fingerprint": "hardware-fingerprint-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "ip_geo_city": "San Francisco",
          "http_status_code": 200,
          "dfp_protected_auth_mode": "decisioning",
          "network_ip_address": "1.1.1.1",
          "is_authentic_device": true,
          "event_id": "event-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "email_address": "john.doe@example.com",
          "service": "stytch.auth",
          "session_duration_minutes": 0,
          "telemetry_id": "a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "time": "2025-07-10T20:03:21.810Z",
          "session_token_hash": "",
          "request_id": "request-id-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "asn": "123456",
          "status": "Success"
      }
    result:
      custom:
        _timestamp: 1752177801810000
        asn: "123456"
        asn_name: "Some ASN Name"
        asn_network: "0.0.0.0/22"
        browser_id: "browser-id-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
        browser_user_agent: "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
        ddsource: "stytch"
        ddtags: "service:stytch.auth,stytch-env:prod"
        detected_device_type: "INTEL_64BIT_LINUX_CHROME"
        dfp_protected_auth_mode: "decisioning"
        external_metadata_external_id: ""
        external_metadata_organization_id: ""
        external_metadata_user_action: "SDKB2BOAuthDiscoveryAuthenticate"
        hardware_fingerprint: "hardware-fingerprint-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
        http:
          status_code: "200"
          user_agent:
           - "Stytch.js Javascript SDK/v5.23.4"
          useragent_details:
            browser:
              family: "Chrome"
              major: "138"
              minor: "0"
              patch: "0"
              patch_minor: "0"
            device:
              category: "Desktop"
              family: "Other"
            os:
              family: "Linux"
        ip_geo_city: "San Francisco"
        ip_geo_region: "California"
        is_authentic_device: true
        level: "ok"
        network:
          client:
            geoip:
              country:
                iso_code: "US"
        network_fingerprint: "network-fingerprint-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
        network_ip_address: "1.1.1.1"
        oauth_config_id: "oauth-config-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
        oauth_provider: "Google"
        project_name: "Stytch"
        service: "stytch.auth"
        session_duration_minutes: 0
        session_jwt_hash: ""
        session_token_hash: ""
        severity: "info"
        stytch:
          action: "B2BOAuthDiscoveryAuthenticate"
          event_id: "event-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
          project_id: "project-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
          request:
            id: "request-id-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
            status: "Success"
        telemetry_id: "a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
        time: "2025-07-10T20:03:21.810Z"
        timestamp: 1752177801810
        usr:
          email: "john.doe@example.com"
        verdict_action: "ALLOW"
        verdict_reasons: ""
        visitor_fingerprint: "visitor-fingerprint-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
        visitor_id: "visitor-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
      message: |-
        {
          "verdict_action" : "ALLOW",
          "ip_geo_region" : "California",
          "ddtags" : "service:stytch.auth,stytch-env:prod",
          "visitor_id" : "visitor-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "visitor_fingerprint" : "visitor-fingerprint-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "project_name" : "Stytch",
          "network_fingerprint" : "network-fingerprint-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "external_metadata_organization_id" : "",
          "detected_device_type" : "INTEL_64BIT_LINUX_CHROME",
          "asn_name" : "Some ASN Name",
          "browser_id" : "browser-id-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "oauth_config_id" : "oauth-config-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "project_id" : "project-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "asn_network" : "0.0.0.0/22",
          "ip_geo_country" : "US",
          "action" : "B2BOAuthDiscoveryAuthenticate",
          "oauth_provider" : "Google",
          "verdict_reasons" : "",
          "_timestamp" : 1752177801810000,
          "user_agent" : [ "Stytch.js Javascript SDK/v5.23.4" ],
          "external_metadata_external_id" : "",
          "external_metadata_user_action" : "SDKB2BOAuthDiscoveryAuthenticate",
          "browser_user_agent" : "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
          "timestamp" : 1752177801810,
          "severity" : "info",
          "session_jwt_hash" : "",
          "hardware_fingerprint" : "hardware-fingerprint-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "ip_geo_city" : "San Francisco",
          "http_status_code" : 200,
          "dfp_protected_auth_mode" : "decisioning",
          "ddsource" : "stytch",
          "network_ip_address" : "1.1.1.1",
          "is_authentic_device" : true,
          "event_id" : "event-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "email_address" : "john.doe@example.com",
          "service" : "stytch.auth",
          "session_duration_minutes" : 0,
          "telemetry_id" : "a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "time" : "2025-07-10T20:03:21.810Z",
          "session_token_hash" : "",
          "request_id" : "request-id-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "asn" : "123456",
          "status" : "Success"
        }
      service: "stytch.auth"
      status: "ok"
      tags:
       - "source:LOGS_SOURCE"
  - sample: |-
      {
          "ddsource": "stytch",
          "ddtags": "service:stytch.auth,stytch-env:prod",
          "authorization_check_resource_id": "workspace",
          "authorization_check_verdict_authorized": true,
          "member_session_id": "member-session-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "authorization_check_action": "read",
          "project_name": "Stytch",
          "authorization_check_verdict_granting_roles": "stytch_admin",
          "project_id": "project-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "action": "MultiTenantSessionsAuthenticate",
          "_timestamp": 1752177390811000,
          "user_agent": [
              "Stytch Go v16.20.0"
          ],
          "timestamp": 1752177390811,
          "severity": "info",
          "member_id": "member-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "session_jwt_hash": "DAQx5FXhE2cA9f42e56lJqsEj_LGLxR4NJ-dwFLenBQ=",
          "authorization_check_organization_id": "organization-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "http_status_code": 200,
          "session_id": "member-session-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "event_id": "event-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "service": "stytch.auth",
          "organization_id": "organization-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "session_duration_minutes": 0,
          "time": "2025-07-10T19:56:30.811Z",
          "session_token_hash": "",
          "request_id": "request-id-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "status": "Success"
      }
    result:
      custom:
        _timestamp: 1752177390811000
        authorization_check_action: "read"
        authorization_check_organization_id: "organization-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
        authorization_check_resource_id: "workspace"
        authorization_check_verdict_authorized: true
        authorization_check_verdict_granting_roles: "stytch_admin"
        ddsource: "stytch"
        ddtags: "service:stytch.auth,stytch-env:prod"
        http:
          status_code: "200"
          user_agent:
           - "Stytch Go v16.20.0"
        level: "ok"
        member_session_id: "member-session-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
        project_name: "Stytch"
        service: "stytch.auth"
        session_duration_minutes: 0
        session_id: "member-session-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
        session_jwt_hash: "DAQx5FXhE2cA9f42e56lJqsEj_LGLxR4NJ-dwFLenBQ="
        session_token_hash: ""
        severity: "info"
        stytch:
          action: "MultiTenantSessionsAuthenticate"
          event_id: "event-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
          member_id: "member-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
          organization_id: "organization-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
          project_id: "project-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
          request:
            id: "request-id-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
            status: "Success"
        time: "2025-07-10T19:56:30.811Z"
        timestamp: 1752177390811
      message: |-
        {
          "authorization_check_resource_id" : "workspace",
          "authorization_check_verdict_authorized" : true,
          "ddtags" : "service:stytch.auth,stytch-env:prod",
          "member_session_id" : "member-session-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "authorization_check_action" : "read",
          "project_name" : "Stytch",
          "authorization_check_verdict_granting_roles" : "stytch_admin",
          "project_id" : "project-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "action" : "MultiTenantSessionsAuthenticate",
          "_timestamp" : 1752177390811000,
          "user_agent" : [ "Stytch Go v16.20.0" ],
          "timestamp" : 1752177390811,
          "severity" : "info",
          "member_id" : "member-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "session_jwt_hash" : "DAQx5FXhE2cA9f42e56lJqsEj_LGLxR4NJ-dwFLenBQ=",
          "authorization_check_organization_id" : "organization-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "http_status_code" : 200,
          "session_id" : "member-session-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "ddsource" : "stytch",
          "event_id" : "event-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "service" : "stytch.auth",
          "organization_id" : "organization-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "session_duration_minutes" : 0,
          "time" : "2025-07-10T19:56:30.811Z",
          "session_token_hash" : "",
          "request_id" : "request-id-live-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "status" : "Success"
        }
      service: "stytch.auth"
      status: "ok"
      tags:
       - "source:LOGS_SOURCE"
  - sample: |-
      {
          "ddsource": "stytch",
          "ddtags": "service:stytch.auth,stytch-env:prod",
          "member_id": "",
          "http_status_code": 200,
          "delivery_latency_seconds": 1,
          "message_status_description": "",
          "message_status": "delivered",
          "event_id": "event-test-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "email_address": "john.doe@example.com",
          "project_id": "project-test-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "service": "stytch.auth",
          "method_id": "",
          "organization_id": "",
          "action": "EmailDelivery",
          "_timestamp": 1752178523862000,
          "time": "2025-07-10T20:15:23.862Z",
          "request_id": "request-id-test-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "status": "Success",
          "timestamp": 1752178523862
      }
    result:
      custom:
        _timestamp: 1752178523862000
        ddsource: "stytch"
        ddtags: "service:stytch.auth,stytch-env:prod"
        error:
          message: ""
        http:
          status_code: "200"
        level: "ok"
        method_id: ""
        service: "stytch.auth"
        stytch:
          action: "EmailDelivery"
          delivery:
            latency_seconds: 1
            message_status: "delivered"
            message_status_description: ""
          event_id: "event-test-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
          member_id: ""
          organization_id: ""
          project_id: "project-test-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
          request:
            id: "request-id-test-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6"
            status: "Success"
        time: "2025-07-10T20:15:23.862Z"
        timestamp: 1752178523862
        usr:
          email: "john.doe@example.com"
      message: |-
        {
          "member_id" : "",
          "ddtags" : "service:stytch.auth,stytch-env:prod",
          "http_status_code" : 200,
          "delivery_latency_seconds" : 1,
          "ddsource" : "stytch",
          "message_status_description" : "",
          "message_status" : "delivered",
          "event_id" : "event-test-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "email_address" : "john.doe@example.com",
          "project_id" : "project-test-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "service" : "stytch.auth",
          "method_id" : "",
          "organization_id" : "",
          "action" : "EmailDelivery",
          "time" : "2025-07-10T20:15:23.862Z",
          "_timestamp" : 1752178523862000,
          "request_id" : "request-id-test-a1b2c3d4-1234-5678-9012-a1b2c3d4e5f6",
          "status" : "Success",
          "timestamp" : 1752178523862
        }
      service: "stytch.auth"
      status: "ok"
      tags:
       - "source:LOGS_SOURCE"
