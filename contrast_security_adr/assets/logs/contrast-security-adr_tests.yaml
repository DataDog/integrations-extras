id: "contrast-security-adr"
tests:
 -
  sample: |-
    {
      "severity" : "critical",
      "detectedTime" : "1764161753000",
      "server" : {
        "name" : "Petclinic-thib",
        "id" : "27958"
      },
      "request" : {
        "headers" : {
          "Cookie" : [ "JSESSIONID=EB2C548D2789AEFB92E843E958D2410E" ],
          "sec-fetch-mode" : [ "navigate" ],
          "referer" : [ "http://localhost:8080/customers/find" ],
          "sec-fetch-site" : [ "same-origin" ],
          "accept-language" : [ "en-GB,en-US;q=0.9,en;q=0.8" ],
          "sec-fetch-user" : [ "?1" ],
          "accept" : [ "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7" ],
          "sec-ch-ua" : [ "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"" ],
          "sec-ch-ua-mobile" : [ "?0" ],
          "sec-ch-ua-platform" : [ "\"macOS\"" ],
          "host" : [ "localhost:8080" ],
          "upgrade-insecure-requests" : [ "1" ],
          "connection" : [ "keep-alive" ],
          "accept-encoding" : [ "gzip, deflate, br, zstd" ],
          "sec-fetch-dest" : [ "document" ],
          "user-agent" : [ "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36" ]
        },
        "protocol" : "http",
        "method" : "GET",
        "protocolVersion" : "1.1",
        "queryString" : "lastName=contrast-redacted-name",
        "parameters" : {
          "lastName" : [ "contrast-redacted-name" ]
        }
      },
      "vectorAnalysis" : {
        "vectorFields" : {
          "ruleUuid" : "sql-injection",
          "query" : "SELECT DISTINCT * FROM customers WHERE customers.last_name LIKE '%' or 1=1; # antwerp%'"
        },
        "callLocation" : "org.springframework.samples.petclinic.customer.CustomerRepository.findByLastName(CustomerRepository.java:31)"
      },
      "attackPayload" : {
        "attackerInput" : {
          "confirmedAttack" : false,
          "documentType" : "NORMAL",
          "effectiveAttack" : false,
          "name" : "lastName",
          "applicableAttack" : false,
          "inputType" : "PARAMETER_VALUE",
          "patternsMatched" : [ "PIDS-SQLI-42A,PIDS-SQLI-44C,TRUING_STRING_INJ,PIDS-SQLI-4001" ],
          "documentPath" : "/abc"
        },
        "value" : "' or 1=1; # antwerp",
        "url" : "/owner"
      },
      "rule" : "sql-injection",
      "eventUuid" : "1678918a-103f-4030-a416-3b8766e47e19",
      "productName" : "ContrastADR",
      "url" : "/customers",
      "result" : "BLOCKED",
      "environment" : "production",
      "organizationUuid" : "203ae021-7e10-4356-ad6e-0c4b94d8511e",
      "incident_id" : "INC-2025-c51",
      "apiUri" : "/api/v4/organizations/203ae021-7e10-4356-ad6e-0c4b94d8511e/applications/08f46d44-b7da-4978-b903-fcce249f457a/attack-events/1678918a-103f-4030-a416-3b8766e47e19",
      "mitreTactics" : [ {
        "id" : "TA0001",
        "url" : "https://attack.mitre.org/tactics/TA0001/"
      }, {
        "id" : "TA0002",
        "url" : "https://attack.mitre.org/tactics/TA0002/"
      }, {
        "id" : "TA0006",
        "url" : "https://attack.mitre.org/tactics/TA0006/"
      }, {
        "id" : "TA0007",
        "url" : "https://attack.mitre.org/tactics/TA0007/"
      }, {
        "id" : "TA0009",
        "url" : "https://attack.mitre.org/tactics/TA0009/"
      }, {
        "id" : "TA0010",
        "url" : "https://attack.mitre.org/tactics/TA0010/"
      } ],
      "application" : {
        "name" : "Web-Application-thib",
        "agentLanguage" : "java",
        "id" : "08f46d44-b7da-4978-b903-fcce249f457a"
      },
      "sourceIp" : "7.7.7.7.7.10",
      "codeLocation" : {
        "stack" : [ {
          "fileName" : "SecurityContextHolderAwareRequestFilter.java",
          "shortSummary" : "doFilter() @ SecurityContextHolderAwareRequestFilter.java:179",
          "description" : "org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)",
          "methodName" : "doFilter",
          "className" : "org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter",
          "type" : "frameCommon",
          "lineNumber" : 179
        }, {
          "fileName" : "ObservationFilterChainDecorator.java",
          "shortSummary" : "wrapFilter() @ ObservationFilterChainDecorator.java:240",
          "description" : "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)",
          "methodName" : "wrapFilter",
          "className" : "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter",
          "type" : "frameCommon",
          "lineNumber" : 240
        }, {
          "fileName" : "ObservationFilterChainDecorator.java",
          "shortSummary" : "doFilter() @ ObservationFilterChainDecorator.java:227",
          "description" : "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)",
          "methodName" : "doFilter",
          "className" : "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter",
          "type" : "frameCommon",
          "lineNumber" : 227
        }, {
          "fileName" : "ObservationFilterChainDecorator.java",
          "shortSummary" : "doFilter() @ ObservationFilterChainDecorator.java:137",
          "description" : "org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)",
          "methodName" : "doFilter",
          "className" : "org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain",
          "type" : "frameCommon",
          "lineNumber" : 137
        } ],
        "file" : "HikariProxyStatement.java",
        "method" : "executeQuery()"
      },
      "ruleUuid" : "ssjs-injection",
      "cloudProvider" : "UNKNOWN",
      "host" : {
        "runtimeVersion" : "OpenJDK Runtime Environment 17.0.14+7",
        "hostname" : "bb8989bc",
        "runtimePath" : "/opt/java/openjdk/bin/java",
        "isDocker" : true,
        "operatingSystem" : "Linux 6.10.14-linuxkit aarch64"
      },
      "agentVersion" : "6.14.0",
      "uiUrl" : "https://teamserver-scantest.contsec.com/Contrast/static/ng/index.html#/203ae021-7e10-4356-ad6e-0c4b94d8511e/attack-events/1678918a-103f-4030-a416-3b8766e47e19?groupBy=&dateRange-type=CUSTOM_DATE_RANGE&dateRange-startDate=1747217573585&dateRange-endDate=1747217693585&applicationId=08f46d44-b7da-4978-b903-fcce249f457a"
    }
  result:
    custom:
      agentVersion: "6.14.0"
      apiUri: "/api/v4/organizations/203ae021-7e10-4356-ad6e-0c4b94d8511e/applications/08f46d44-b7da-4978-b903-fcce249f457a/attack-events/1678918a-103f-4030-a416-3b8766e47e19"
      application:
        agentLanguage: "java"
        id: "08f46d44-b7da-4978-b903-fcce249f457a"
        name: "Web-Application-thib"
      attackPayload:
        attackerInput:
          applicableAttack: false
          confirmedAttack: false
          documentPath: "/abc"
          documentType: "NORMAL"
          effectiveAttack: false
          inputType: "PARAMETER_VALUE"
          name: "lastName"
          patternsMatched:
           - "PIDS-SQLI-42A,PIDS-SQLI-44C,TRUING_STRING_INJ,PIDS-SQLI-4001"
        url: "/owner"
        value: "' or 1=1; # antwerp"
      cloudProvider: "UNKNOWN"
      codeLocation:
        file: "HikariProxyStatement.java"
        method: "executeQuery()"
        stack:
         -
          fileName: "SecurityContextHolderAwareRequestFilter.java"
          shortSummary: "doFilter() @ SecurityContextHolderAwareRequestFilter.java:179"
          description: "org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)"
          methodName: "doFilter"
          className: "org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter"
          type: "frameCommon"
          lineNumber: 179
         -
          fileName: "ObservationFilterChainDecorator.java"
          shortSummary: "wrapFilter() @ ObservationFilterChainDecorator.java:240"
          description: "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)"
          methodName: "wrapFilter"
          className: "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter"
          type: "frameCommon"
          lineNumber: 240
         -
          fileName: "ObservationFilterChainDecorator.java"
          shortSummary: "doFilter() @ ObservationFilterChainDecorator.java:227"
          description: "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)"
          methodName: "doFilter"
          className: "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter"
          type: "frameCommon"
          lineNumber: 227
         -
          fileName: "ObservationFilterChainDecorator.java"
          shortSummary: "doFilter() @ ObservationFilterChainDecorator.java:137"
          description: "org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)"
          methodName: "doFilter"
          className: "org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain"
          type: "frameCommon"
          lineNumber: 137
      contrast_adr:
        incident_id: "INC-2025-c51"
      date: "1764161753000"
      detectedTime: "1764161753000"
      environment: "production"
      eventUuid: "1678918a-103f-4030-a416-3b8766e47e19"
      evt:
        name: "sql-injection"
        outcome: "BLOCKED"
      host:
        hostname: "bb8989bc"
        isDocker: true
        operatingSystem: "Linux 6.10.14-linuxkit aarch64"
        runtimePath: "/opt/java/openjdk/bin/java"
        runtimeVersion: "OpenJDK Runtime Environment 17.0.14+7"
      http:
        method: "GET"
        referer:
         - "http://localhost:8080/customers/find"
        request:
          headers:
            Cookie:
             - "JSESSIONID=EB2C548D2789AEFB92E843E958D2410E"
            accept:
             - "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
            accept-encoding:
             - "gzip, deflate, br, zstd"
            accept-language:
             - "en-GB,en-US;q=0.9,en;q=0.8"
            connection:
             - "keep-alive"
            host:
             - "localhost:8080"
            referer:
             - "http://localhost:8080/customers/find"
            sec-ch-ua:
             - "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\""
            sec-ch-ua-mobile:
             - "?0"
            sec-ch-ua-platform:
             - "\"macOS\""
            sec-fetch-dest:
             - "document"
            sec-fetch-mode:
             - "navigate"
            sec-fetch-site:
             - "same-origin"
            sec-fetch-user:
             - "?1"
            upgrade-insecure-requests:
             - "1"
            user-agent:
             - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"
        url_details:
          host:
           - "localhost:8080"
          path:
            path: "/api/v4/organizations/203ae021-7e10-4356-ad6e-0c4b94d8511e/applications/08f46d44-b7da-4978-b903-fcce249f457a/attack-events/1678918a-103f-4030-a416-3b8766e47e19"
          queryString: "lastName=contrast-redacted-name"
          scheme: "http"
        user-agent:
         - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"
        useragent_details:
          os:
            family: "Linux 6.10.14-linuxkit aarch64"
        version: "1.1"
      incident_id: "INC-2025-c51"
      mitreTactics:
       -
        id: "TA0001"
        url: "https://attack.mitre.org/tactics/TA0001/"
       -
        id: "TA0002"
        url: "https://attack.mitre.org/tactics/TA0002/"
       -
        id: "TA0006"
        url: "https://attack.mitre.org/tactics/TA0006/"
       -
        id: "TA0007"
        url: "https://attack.mitre.org/tactics/TA0007/"
       -
        id: "TA0009"
        url: "https://attack.mitre.org/tactics/TA0009/"
       -
        id: "TA0010"
        url: "https://attack.mitre.org/tactics/TA0010/"
      network:
        host:
          ip: "7.7.7.7.7.10"
          name: "bb8989bc"
      organizationUuid: "203ae021-7e10-4356-ad6e-0c4b94d8511e"
      productName: "ContrastADR"
      request:
        headers:
          Cookie:
           - "JSESSIONID=EB2C548D2789AEFB92E843E958D2410E"
          accept:
           - "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"
          accept-encoding:
           - "gzip, deflate, br, zstd"
          accept-language:
           - "en-GB,en-US;q=0.9,en;q=0.8"
          connection:
           - "keep-alive"
          host:
           - "localhost:8080"
          referer:
           - "http://localhost:8080/customers/find"
          sec-ch-ua:
           - "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\""
          sec-ch-ua-mobile:
           - "?0"
          sec-ch-ua-platform:
           - "\"macOS\""
          sec-fetch-dest:
           - "document"
          sec-fetch-mode:
           - "navigate"
          sec-fetch-site:
           - "same-origin"
          sec-fetch-user:
           - "?1"
          upgrade-insecure-requests:
           - "1"
          user-agent:
           - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"
        method: "GET"
        parameters:
          lastName:
           - "contrast-redacted-name"
        protocol: "http"
        protocolVersion: "1.1"
        queryString: "lastName=contrast-redacted-name"
      result: "BLOCKED"
      rule: "sql-injection"
      ruleUuid: "ssjs-injection"
      server:
        id: "27958"
        name: "Petclinic-thib"
      severity: "critical"
      sourceIp: "7.7.7.7.7.10"
      uiUrl: "https://teamserver-scantest.contsec.com/Contrast/static/ng/index.html#/203ae021-7e10-4356-ad6e-0c4b94d8511e/attack-events/1678918a-103f-4030-a416-3b8766e47e19?groupBy=&dateRange-type=CUSTOM_DATE_RANGE&dateRange-startDate=1747217573585&dateRange-endDate=1747217693585&applicationId=08f46d44-b7da-4978-b903-fcce249f457a"
      url: "/customers"
      vectorAnalysis:
        callLocation: "org.springframework.samples.petclinic.customer.CustomerRepository.findByLastName(CustomerRepository.java:31)"
        vectorFields:
          query: "SELECT DISTINCT * FROM customers WHERE customers.last_name LIKE '%' or 1=1; # antwerp%'"
          ruleUuid: "sql-injection"
      version: "6.14.0"
    message: |-
      {
        "severity" : "critical",
        "detectedTime" : "1764161753000",
        "server" : {
          "name" : "Petclinic-thib",
          "id" : "27958"
        },
        "request" : {
          "headers" : {
            "Cookie" : [ "JSESSIONID=EB2C548D2789AEFB92E843E958D2410E" ],
            "sec-fetch-mode" : [ "navigate" ],
            "referer" : [ "http://localhost:8080/customers/find" ],
            "sec-fetch-site" : [ "same-origin" ],
            "accept-language" : [ "en-GB,en-US;q=0.9,en;q=0.8" ],
            "sec-fetch-user" : [ "?1" ],
            "accept" : [ "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7" ],
            "sec-ch-ua" : [ "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"" ],
            "sec-ch-ua-mobile" : [ "?0" ],
            "sec-ch-ua-platform" : [ "\"macOS\"" ],
            "host" : [ "localhost:8080" ],
            "upgrade-insecure-requests" : [ "1" ],
            "connection" : [ "keep-alive" ],
            "accept-encoding" : [ "gzip, deflate, br, zstd" ],
            "sec-fetch-dest" : [ "document" ],
            "user-agent" : [ "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36" ]
          },
          "protocol" : "http",
          "method" : "GET",
          "protocolVersion" : "1.1",
          "queryString" : "lastName=contrast-redacted-name",
          "parameters" : {
            "lastName" : [ "contrast-redacted-name" ]
          }
        },
        "vectorAnalysis" : {
          "vectorFields" : {
            "ruleUuid" : "sql-injection",
            "query" : "SELECT DISTINCT * FROM customers WHERE customers.last_name LIKE '%' or 1=1; # antwerp%'"
          },
          "callLocation" : "org.springframework.samples.petclinic.customer.CustomerRepository.findByLastName(CustomerRepository.java:31)"
        },
        "attackPayload" : {
          "attackerInput" : {
            "confirmedAttack" : false,
            "documentType" : "NORMAL",
            "effectiveAttack" : false,
            "name" : "lastName",
            "applicableAttack" : false,
            "inputType" : "PARAMETER_VALUE",
            "patternsMatched" : [ "PIDS-SQLI-42A,PIDS-SQLI-44C,TRUING_STRING_INJ,PIDS-SQLI-4001" ],
            "documentPath" : "/abc"
          },
          "value" : "' or 1=1; # antwerp",
          "url" : "/owner"
        },
        "rule" : "sql-injection",
        "eventUuid" : "1678918a-103f-4030-a416-3b8766e47e19",
        "productName" : "ContrastADR",
        "url" : "/customers",
        "result" : "BLOCKED",
        "environment" : "production",
        "organizationUuid" : "203ae021-7e10-4356-ad6e-0c4b94d8511e",
        "incident_id" : "INC-2025-c51",
        "apiUri" : "/api/v4/organizations/203ae021-7e10-4356-ad6e-0c4b94d8511e/applications/08f46d44-b7da-4978-b903-fcce249f457a/attack-events/1678918a-103f-4030-a416-3b8766e47e19",
        "mitreTactics" : [ {
          "id" : "TA0001",
          "url" : "https://attack.mitre.org/tactics/TA0001/"
        }, {
          "id" : "TA0002",
          "url" : "https://attack.mitre.org/tactics/TA0002/"
        }, {
          "id" : "TA0006",
          "url" : "https://attack.mitre.org/tactics/TA0006/"
        }, {
          "id" : "TA0007",
          "url" : "https://attack.mitre.org/tactics/TA0007/"
        }, {
          "id" : "TA0009",
          "url" : "https://attack.mitre.org/tactics/TA0009/"
        }, {
          "id" : "TA0010",
          "url" : "https://attack.mitre.org/tactics/TA0010/"
        } ],
        "application" : {
          "name" : "Web-Application-thib",
          "agentLanguage" : "java",
          "id" : "08f46d44-b7da-4978-b903-fcce249f457a"
        },
        "sourceIp" : "7.7.7.7.7.10",
        "codeLocation" : {
          "stack" : [ {
            "fileName" : "SecurityContextHolderAwareRequestFilter.java",
            "shortSummary" : "doFilter() @ SecurityContextHolderAwareRequestFilter.java:179",
            "description" : "org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)",
            "methodName" : "doFilter",
            "className" : "org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter",
            "type" : "frameCommon",
            "lineNumber" : 179
          }, {
            "fileName" : "ObservationFilterChainDecorator.java",
            "shortSummary" : "wrapFilter() @ ObservationFilterChainDecorator.java:240",
            "description" : "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)",
            "methodName" : "wrapFilter",
            "className" : "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter",
            "type" : "frameCommon",
            "lineNumber" : 240
          }, {
            "fileName" : "ObservationFilterChainDecorator.java",
            "shortSummary" : "doFilter() @ ObservationFilterChainDecorator.java:227",
            "description" : "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)",
            "methodName" : "doFilter",
            "className" : "org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter",
            "type" : "frameCommon",
            "lineNumber" : 227
          }, {
            "fileName" : "ObservationFilterChainDecorator.java",
            "shortSummary" : "doFilter() @ ObservationFilterChainDecorator.java:137",
            "description" : "org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)",
            "methodName" : "doFilter",
            "className" : "org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain",
            "type" : "frameCommon",
            "lineNumber" : 137
          } ],
          "file" : "HikariProxyStatement.java",
          "method" : "executeQuery()"
        },
        "ruleUuid" : "ssjs-injection",
        "cloudProvider" : "UNKNOWN",
        "host" : {
          "runtimeVersion" : "OpenJDK Runtime Environment 17.0.14+7",
          "hostname" : "bb8989bc",
          "runtimePath" : "/opt/java/openjdk/bin/java",
          "isDocker" : true,
          "operatingSystem" : "Linux 6.10.14-linuxkit aarch64"
        },
        "agentVersion" : "6.14.0",
        "uiUrl" : "https://teamserver-scantest.contsec.com/Contrast/static/ng/index.html#/203ae021-7e10-4356-ad6e-0c4b94d8511e/attack-events/1678918a-103f-4030-a416-3b8766e47e19?groupBy=&dateRange-type=CUSTOM_DATE_RANGE&dateRange-startDate=1747217573585&dateRange-endDate=1747217693585&applicationId=08f46d44-b7da-4978-b903-fcce249f457a"
      }
    status: "critical"
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1
