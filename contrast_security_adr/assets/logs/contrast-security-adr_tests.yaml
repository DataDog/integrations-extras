id: "contrast-security-adr"
tests:
 -
  sample: |-
    {
      "severity" : "CRITICAL",
      "detectedTime" : "2025-05-16T09:29:22.037Z",
      "server" : {
        "name" : "3e31b90dd191",
        "id" : 30035
      },
      "attackPayload" : {
        "attackerInput" : {
          "confirmedAttack" : false,
          "documentType" : "NORMAL",
          "effectiveAttack" : false,
          "name" : "d','4'),('e",
          "applicableAttack" : false,
          "patternsMatched" : [ "" ],
          "type" : "QUERYSTRING",
          "documentPath" : ""
        },
        "standardNormalizedUri" : "",
        "value" : "d','4'),('e",
        "url" : "/vulnpy/sqli/sqlite3-execute/"
      },
      "rule" : "sql-injection",
      "eventUuid" : "a6aab11a-de46-4154-bd09-ee966ee0af33",
      "productName" : "ContrastADR",
      "result" : "EXPLOITED",
      "environment" : "DEVELOPMENT",
      "organizationUuid" : "969321ad-da28-4c8a-9bac-18ca5553b301",
      "apiUri" : "/api/v4/organizations/969321ad-da28-4c8a-9bac-18ca5553b301/applications/3bc81309-ab9b-45c1-8944-6d6242fa835f/attack-events/a6aab11a-de46-4154-bd09-ee966ee0af33",
      "mitreTactics" : [ {
        "name" : "Initial Access",
        "id" : "TA0001",
        "url" : "https://attack.mitre.org/tactics/TA0001/"
      }, {
        "name" : "Execution",
        "id" : "TA0002",
        "url" : "https://attack.mitre.org/tactics/TA0002/"
      }, {
        "name" : "Persistence",
        "id" : "TA0003",
        "url" : "https://attack.mitre.org/tactics/TA0003/"
      }, {
        "name" : "Privilege Escalation",
        "id" : "TA0004",
        "url" : "https://attack.mitre.org/tactics/TA0004/"
      }, {
        "name" : "Defense Evasion",
        "id" : "TA0005",
        "url" : "https://attack.mitre.org/tactics/TA0005/"
      }, {
        "name" : "Credential Access",
        "id" : "TA0006",
        "url" : "https://attack.mitre.org/tactics/TA0006/"
      }, {
        "name" : "Discovery",
        "id" : "TA0007",
        "url" : "https://attack.mitre.org/tactics/TA0007/"
      }, {
        "name" : "Collection",
        "id" : "TA0009",
        "url" : "https://attack.mitre.org/tactics/TA0009/"
      }, {
        "name" : "Exfiltration",
        "id" : "TA0010",
        "url" : "https://attack.mitre.org/tactics/TA0010/"
      } ],
      "application" : {
        "name" : "Vulnpy_NS_test1",
        "agentLanguage" : "python",
        "id" : "3bc81309-ab9b-45c1-8944-6d6242fa835f"
      },
      "sourceIp" : "192.168.65.1",
      "cloudProvider" : "UNKNOWN",
      "uiUrl" : "https://apptwo.contrastsecurity.com/Contrast/static/ng/index.html#/969321ad-da28-4c8a-9bac-18ca5553b301/attack-events/a6aab11a-de46-4154-bd09-ee966ee0af33?groupBy=&amp;dateRange-type=CUSTOM_DATE_RANGE&amp;dateRange-startDate=1747387702037&amp;dateRange-endDate=1747387822037&amp;applicationId=3bc81309-ab9b-45c1-8944-6d6242fa835f"
    }
  result:
    custom:
      apiUri: "/api/v4/organizations/969321ad-da28-4c8a-9bac-18ca5553b301/applications/3bc81309-ab9b-45c1-8944-6d6242fa835f/attack-events/a6aab11a-de46-4154-bd09-ee966ee0af33"
      application:
        agentLanguage: "python"
        id: "3bc81309-ab9b-45c1-8944-6d6242fa835f"
        name: "Vulnpy_NS_test1"
      attackPayload:
        attackerInput:
          applicableAttack: false
          confirmedAttack: false
          documentPath: ""
          documentType: "NORMAL"
          effectiveAttack: false
          name: "d','4'),('e"
          patternsMatched:
           - ""
          type: "QUERYSTRING"
        standardNormalizedUri: ""
        url: "/vulnpy/sqli/sqlite3-execute/"
        value: "d','4'),('e"
      cloudProvider: "UNKNOWN"
      detectedTime: "2025-05-16T09:29:22.037Z"
      environment: "DEVELOPMENT"
      eventUuid: "a6aab11a-de46-4154-bd09-ee966ee0af33"
      mitreTactics:
       -
        name: "Initial Access"
        id: "TA0001"
        url: "https://attack.mitre.org/tactics/TA0001/"
       -
        name: "Execution"
        id: "TA0002"
        url: "https://attack.mitre.org/tactics/TA0002/"
       -
        name: "Persistence"
        id: "TA0003"
        url: "https://attack.mitre.org/tactics/TA0003/"
       -
        name: "Privilege Escalation"
        id: "TA0004"
        url: "https://attack.mitre.org/tactics/TA0004/"
       -
        name: "Defense Evasion"
        id: "TA0005"
        url: "https://attack.mitre.org/tactics/TA0005/"
       -
        name: "Credential Access"
        id: "TA0006"
        url: "https://attack.mitre.org/tactics/TA0006/"
       -
        name: "Discovery"
        id: "TA0007"
        url: "https://attack.mitre.org/tactics/TA0007/"
       -
        name: "Collection"
        id: "TA0009"
        url: "https://attack.mitre.org/tactics/TA0009/"
       -
        name: "Exfiltration"
        id: "TA0010"
        url: "https://attack.mitre.org/tactics/TA0010/"
      organizationUuid: "969321ad-da28-4c8a-9bac-18ca5553b301"
      productName: "ContrastADR"
      result: "EXPLOITED"
      rule: "sql-injection"
      server:
        id: 30035
        name: "3e31b90dd191"
      severity: "CRITICAL"
      sourceIp: "192.168.65.1"
      uiUrl: "https://apptwo.contrastsecurity.com/Contrast/static/ng/index.html#/969321ad-da28-4c8a-9bac-18ca5553b301/attack-events/a6aab11a-de46-4154-bd09-ee966ee0af33?groupBy=&amp;dateRange-type=CUSTOM_DATE_RANGE&amp;dateRange-startDate=1747387702037&amp;dateRange-endDate=1747387822037&amp;applicationId=3bc81309-ab9b-45c1-8944-6d6242fa835f"
    message: |-
      {
        "severity" : "CRITICAL",
        "detectedTime" : "2025-05-16T09:29:22.037Z",
        "server" : {
          "name" : "3e31b90dd191",
          "id" : 30035
        },
        "attackPayload" : {
          "attackerInput" : {
            "confirmedAttack" : false,
            "documentType" : "NORMAL",
            "effectiveAttack" : false,
            "name" : "d','4'),('e",
            "applicableAttack" : false,
            "patternsMatched" : [ "" ],
            "type" : "QUERYSTRING",
            "documentPath" : ""
          },
          "standardNormalizedUri" : "",
          "value" : "d','4'),('e",
          "url" : "/vulnpy/sqli/sqlite3-execute/"
        },
        "rule" : "sql-injection",
        "eventUuid" : "a6aab11a-de46-4154-bd09-ee966ee0af33",
        "productName" : "ContrastADR",
        "result" : "EXPLOITED",
        "environment" : "DEVELOPMENT",
        "organizationUuid" : "969321ad-da28-4c8a-9bac-18ca5553b301",
        "apiUri" : "/api/v4/organizations/969321ad-da28-4c8a-9bac-18ca5553b301/applications/3bc81309-ab9b-45c1-8944-6d6242fa835f/attack-events/a6aab11a-de46-4154-bd09-ee966ee0af33",
        "mitreTactics" : [ {
          "name" : "Initial Access",
          "id" : "TA0001",
          "url" : "https://attack.mitre.org/tactics/TA0001/"
        }, {
          "name" : "Execution",
          "id" : "TA0002",
          "url" : "https://attack.mitre.org/tactics/TA0002/"
        }, {
          "name" : "Persistence",
          "id" : "TA0003",
          "url" : "https://attack.mitre.org/tactics/TA0003/"
        }, {
          "name" : "Privilege Escalation",
          "id" : "TA0004",
          "url" : "https://attack.mitre.org/tactics/TA0004/"
        }, {
          "name" : "Defense Evasion",
          "id" : "TA0005",
          "url" : "https://attack.mitre.org/tactics/TA0005/"
        }, {
          "name" : "Credential Access",
          "id" : "TA0006",
          "url" : "https://attack.mitre.org/tactics/TA0006/"
        }, {
          "name" : "Discovery",
          "id" : "TA0007",
          "url" : "https://attack.mitre.org/tactics/TA0007/"
        }, {
          "name" : "Collection",
          "id" : "TA0009",
          "url" : "https://attack.mitre.org/tactics/TA0009/"
        }, {
          "name" : "Exfiltration",
          "id" : "TA0010",
          "url" : "https://attack.mitre.org/tactics/TA0010/"
        } ],
        "application" : {
          "name" : "Vulnpy_NS_test1",
          "agentLanguage" : "python",
          "id" : "3bc81309-ab9b-45c1-8944-6d6242fa835f"
        },
        "sourceIp" : "192.168.65.1",
        "cloudProvider" : "UNKNOWN",
        "uiUrl" : "https://apptwo.contrastsecurity.com/Contrast/static/ng/index.html#/969321ad-da28-4c8a-9bac-18ca5553b301/attack-events/a6aab11a-de46-4154-bd09-ee966ee0af33?groupBy=&amp;dateRange-type=CUSTOM_DATE_RANGE&amp;dateRange-startDate=1747387702037&amp;dateRange-endDate=1747387822037&amp;applicationId=3bc81309-ab9b-45c1-8944-6d6242fa835f"
      }
    tags:
     - "source:LOGS_SOURCE"
    timestamp: 1
