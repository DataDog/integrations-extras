id: "contrast-security-adr"
tests:
 -
  sample: |-
    {
      "hostname" : "",
      "ddtags" : "incident_event",
      "service" : "ContrastADR",
      "message" : {
        "severity" : "Error",
        "summary" : " observed the following suspicious value accessing the application through the HTTP Request Parameter query cat /etc/passwd",
        "alertType" : "incident_created",
        "alertReason" : "Incident Created",
        "source" : "security",
        "eventType" : "incidentalert",
        "recommendedRunbooks" : [ "https://dev/adr-runbooks/runbooks/path-traversal/" ],
        "url" : "https://apptwo.com/cs/index.html#/0f767995-4882-4c7c-889f-994d945ff0d5/incidents/INC-2025-6",
        "relatedRules" : [ "path-traversal" ],
        "score" : 9.3,
        "organizationUuid" : "0f767995-4882-4c7c-889f-994d945ff0d5",
        "createdTime" : "2025-07-25T06:20:23.0000Z",
        "recommendedActions" : [ "We did not block this attack because blocking was not enabled for DM-ADR-Web-Application in Production.", "Add an exclusion for this attack event." ],
        "incidentId" : "INC-2025-c61",
        "incidentName" : "Path Traversal on \"/postjsoncmd\"",
        "status" : "Close",
        "timestamp" : "2025-07-25T06:20:23.0000Z"
      },
      "ddsource" : "contrast-security-adr"
    }
  result:
    custom:
      alertReason: "Incident Created"
      alertType: "incident_created"
      createdTime: "2025-07-25T06:20:23.0000Z"
      ddsource: "contrast-security-adr"
      ddtags: "incident_event"
      eventType: "incidentalert"
      hostname: ""
      incidentId: "INC-2025-c61"
      incidentName: "Path Traversal on \"/postjsoncmd\""
      organizationUuid: "0f767995-4882-4c7c-889f-994d945ff0d5"
      recommendedActions:
       - "We did not block this attack because blocking was not enabled for DM-ADR-Web-Application in Production."
       - "Add an exclusion for this attack event."
      recommendedRunbooks:
       - "https://dev/adr-runbooks/runbooks/path-traversal/"
      relatedRules:
       - "path-traversal"
      score: 9.3
      service: "ContrastADR"
      severity: "Error"
      source: "security"
      status: "Close"
      summary: " observed the following suspicious value accessing the application through the HTTP Request Parameter query cat /etc/passwd"
      timestamp: "2025-07-25T06:20:23.0000Z"
      url: "https://apptwo.com/cs/index.html#/0f767995-4882-4c7c-889f-994d945ff0d5/incidents/INC-2025-6"
    message: |-
      {
        "hostname" : "",
        "ddtags" : "incident_event",
        "service" : "ContrastADR",
        "message" : {
          "severity" : "Error",
          "summary" : " observed the following suspicious value accessing the application through the HTTP Request Parameter query cat /etc/passwd",
          "alertType" : "incident_created",
          "alertReason" : "Incident Created",
          "source" : "security",
          "eventType" : "incidentalert",
          "recommendedRunbooks" : [ "https://dev/adr-runbooks/runbooks/path-traversal/" ],
          "url" : "https://apptwo.com/cs/index.html#/0f767995-4882-4c7c-889f-994d945ff0d5/incidents/INC-2025-6",
          "relatedRules" : [ "path-traversal" ],
          "score" : 9.3,
          "organizationUuid" : "0f767995-4882-4c7c-889f-994d945ff0d5",
          "createdTime" : "2025-07-25T06:20:23.0000Z",
          "recommendedActions" : [ "We did not block this attack because blocking was not enabled for DM-ADR-Web-Application in Production.", "Add an exclusion for this attack event." ],
          "incidentId" : "INC-2025-c61",
          "incidentName" : "Path Traversal on \"/postjsoncmd\"",
          "status" : "Close",
          "timestamp" : "2025-07-25T06:20:23.0000Z"
        },
        "ddsource" : "contrast-security-adr"
      }
    tags:
     - "source:LOGS_SOURCE"
