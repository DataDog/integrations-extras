id: contrast-security-adr
# See app_id in your integration's manifest.json file to learn more:
# https://docs.datadoghq.com/developers/integrations/check_references/#manifest-file
metric_id: contrast-security-adr
# If for some reason id must be different than app_id, add the app_id in this field instead.
# If id and app_id already match, this field can be left blank.
backend_only: false
facets:
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - Web Access
    name: Method
    path: http.method
    source: log
  - groups:
      - Web Access
    name: URL scheme
    path: http.url_details.scheme
    source: log
  - groups:
      - Web Access
    name: Version
    path: http.version
    source: log
  - groups:
      - Event
    name: Event Outcome
    path: evt.outcome
    source: log
  - groups:
      - Web Access
    name: URL Path
    path: http.url_details.path
    source: log
  - groups:
      - Web Access
    name: Referer
    path: http.referer
    source: log
  - groups:
      - Web Access
    name: URL Host
    path: http.url_details.host
    source: log
  - groups:
      - Event
    name: Event Name
    path: evt.name
    source: log
  - groups:
      - Web Access
    name: OS
    path: http.useragent_details.os.family
    source: log
  - description: ""
    facetType: list
    groups:
      - ContrastADR-Incident
    name: Created Time
    path: createdTime
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - ContrastADR-Incident
    name: Event Type
    path: eventType
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - ContrastADR-Incident
    name: Incident Score
    path: score
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - ContrastADR-Incident
    name: Organization Uuid
    path: organizationUuid
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - ContrastADR-Incident
    name: Status
    path: severity
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - ContrastADR-Incident
    name: Timestamp
    path: timestamp
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - ContrastADR-Incident
    name: URL
    path: url
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: agentVersion
    path: agentVersion
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: apiUri
    path: apiUri
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: host.hostname
    path: host.hostname
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: host.operatingSystem
    path: host.operatingSystem
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: request.headers.host
    path: request.headers.host
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: request.headers.referer
    path: request.headers.referer
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: request.headers.user-agent
    path: request.headers.user-agent
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: request.method
    path: request.method
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: request.protocol
    path: request.protocol
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: request.protocolVersion
    path: request.protocolVersion
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: request.queryString
    path: request.queryString
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: result
    path: result
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: rule
    path: rule
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrast
    name: sourceIp
    path: sourceIp
    source: log
    type: string
pipeline:
  type: pipeline
  name: Contrast ADR Pipeline
  enabled: true
  filter:
    query: source:contrast-security-adr
  processors:
    - type: pipeline
      name: Contrast ADR Incidents
      enabled: true
      filter:
        query: source:contrast-security-adr
      processors:
        - type: attribute-remapper
          name: "Remapper: Map `incidentId` to `resource.id`"
          enabled: true
          sources:
            - incidentId
          sourceType: attribute
          target: resource.id
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `score` to `syslog.severity`"
          enabled: true
          sources:
            - score
          sourceType: attribute
          target: syslog.severity
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `url` to `resource.url`"
          enabled: true
          sources:
            - url
          sourceType: attribute
          target: resource.url
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `createdTime` to `date`"
          enabled: true
          sources:
            - createdTime
          sourceType: attribute
          target: date
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `eventType` to `resource.type`"
          enabled: true
          sources:
            - eventType
          sourceType: attribute
          target: resource.type
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: status-remapper
          name: "Status Remapper: Map `severity`"
          enabled: true
          sources:
            - severity
        - type: date-remapper
          name: "Date Remapper: 'timestamp'"
          enabled: true
          sources:
            - timestamp
    - type: pipeline
      name: Contrast ADR Attack Events
      enabled: true
      filter:
        query: source:contrast-security-adr
      processors:
        - type: attribute-remapper
          name: "Remapper: Map `sourceIp` to `network.client.ip`"
          enabled: true
          sources:
            - sourceIp
          sourceType: attribute
          target: network.client.ip
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: " Remapper: Map `request.method` to `http.method`"
          enabled: true
          sources:
            - request.method
          sourceType: attribute
          target: http.method
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `request.protocol` to `http.url_details.scheme`"
          enabled: true
          sources:
            - request.protocol
          sourceType: attribute
          target: http.url_details.scheme
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `request.queryString` to `http.url_details.queryString`"
          enabled: true
          sources:
            - request.queryString
          sourceType: attribute
          target: http.url_details.queryString
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `request.protocolVersion` to `http.version`"
          enabled: true
          sources:
            - request.protocolVersion
          sourceType: attribute
          target: http.version
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: date-remapper
          name: "Remapper: Map `detectedTime` "
          enabled: true
          sources:
            - detectedTime
        - type: attribute-remapper
          name: "Remapper: Map `result` to `evt.outcome`"
          enabled: true
          sources:
            - result
          sourceType: attribute
          target: evt.outcome
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: url-parser
          name: "URL Parser : Map `apiUri` to `http.url_details.path`"
          enabled: true
          sources:
            - apiUri
          target: http.url_details.path
          normalizeEndingSlashes: false
        - type: attribute-remapper
          name: "Remapper: Map `request.headers.referer` to `http.referer`"
          enabled: true
          sources:
            - request.headers.referer
          sourceType: attribute
          target: http.referer
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `request.headers.host` to `http.url_details.host`"
          enabled: true
          sources:
            - request.headers.host
          sourceType: attribute
          target: http.url_details.host
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `request.headers` to `http.request.headers`"
          enabled: true
          sources:
            - request.headers
          sourceType: attribute
          target: http.request.headers
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper : Map `request.headers.user-agent` to `http.user-agent`"
          enabled: true
          sources:
            - request.headers.user-agent
          sourceType: attribute
          target: http.user-agent
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `rule` to `evt.name`"
          enabled: true
          sources:
            - rule
          sourceType: attribute
          target: evt.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `host.operatingSystem` to
            `http.useragent_details.os.family`"
          enabled: true
          sources:
            - host.operatingSystem
          sourceType: attribute
          target: http.useragent_details.os.family
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `host.hostname` to `network.host.name`"
          enabled: true
          sources:
            - host.hostname
          sourceType: attribute
          target: network.host.name
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
        - type: attribute-remapper
          name: "Remapper: Map `agentVersion` to `version`"
          enabled: true
          sources:
            - agentVersion
          sourceType: attribute
          target: version
          targetType: attribute
          preserveSource: true
          overrideOnConflict: false
