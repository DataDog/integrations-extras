id: contrast-security-adr
# See app_id in your integration's manifest.json file to learn more:
# https://docs.datadoghq.com/developers/integrations/check_references/#manifest-file
metric_id: contrast-security-adr
# If for some reason id must be different than app_id, add the app_id in this field instead.
# If id and app_id already match, this field can be left blank.
backend_only: false
facets:
  - groups:
      - Web Access
    name: Client IP
    path: network.client.ip
    source: log
  - groups:
      - Web Access
    name: Method
    path: http.method
    source: log
  - groups:
      - Web Access
    name: URL scheme
    path: http.url_details.scheme
    source: log
  - groups:
      - Web Access
    name: Version
    path: http.version
    source: log
  - groups:
      - Event
    name: Event Outcome
    path: evt.outcome
    source: log
  - groups:
      - Web Access
    name: URL Path
    path: http.url_details.path
    source: log
  - groups:
      - Web Access
    name: Referer
    path: http.referer
    source: log
  - groups:
      - Web Access
    name: URL Host
    path: http.url_details.host
    source: log
  - groups:
      - Event
    name: Event Name
    path: evt.name
    source: log
  - groups:
      - Web Access
    name: OS
    path: http.useragent_details.os.family
    source: log
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.agentVersion
    path: event.agentVersion
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.apiUri
    path: event.apiUri
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.detectedTime
    path: event.detectedTime
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.host.hostname
    path: event.host.hostname
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.host.operatingSystem
    path: event.host.operatingSystem
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.request.headers.host
    path: event.request.headers.host
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.request.headers.referer
    path: event.request.headers.referer
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.request.headers.user-agent
    path: event.request.headers.user-agent
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.request.method
    path: event.request.method
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.request.protocol
    path: event.request.protocol
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.request.protocolVersion
    path: event.request.protocolVersion
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.request.queryString
    path: event.request.queryString
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.result
    path: event.result
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.rule
    path: event.rule
    source: log
    type: string
  - description: ""
    facetType: list
    groups:
      - Contrastadr-attackObservation
    name: event.sourceIp
    path: event.sourceIp
    source: log
    type: string
pipeline:
  type: pipeline
  name: " Contrast ADR Pipeline"
  enabled: true
  filter:
    query: source:contrast-security-adr
  processors:
    - type: attribute-remapper
      name: "Map `event.sourceIp` to `network.client.ip`"
      enabled: true
      sources:
        - event.sourceIp
      sourceType: attribute
      target: network.client.ip
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.request.method` to `http.method`"
      enabled: true
      sources:
        - event.request.method
      sourceType: attribute
      target: http.method
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.request.protocol` to `http.url_details.scheme`"
      enabled: true
      sources:
        - event.request.protocol
      sourceType: attribute
      target: http.url_details.scheme
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.request.queryString` to `http.url_details.queryString`"
      enabled: true
      sources:
        - event.request.queryString
      sourceType: attribute
      target: http.url_details.queryString
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.request.protocolVersion` to `http.version`"
      enabled: true
      sources:
        - event.request.protocolVersion
      sourceType: attribute
      target: http.version
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: date-remapper
      name: "Define `event.detectedTime` as the official date of the log"
      enabled: true
      sources:
        - event.detectedTime
    - type: attribute-remapper
      name: "Map `event.result` to `evt.outcome`"
      enabled: true
      sources:
        - event.result
      sourceType: attribute
      target: evt.outcome
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: url-parser
      name: "URL Parser : Map `event.apiUri` to `http.url_details.path`"
      enabled: true
      sources:
        - event.apiUri
      target: http.url_details.path
      normalizeEndingSlashes: false
    - type: attribute-remapper
      name: "Map `event.request.headers.referer` to `http.referer`"
      enabled: true
      sources:
        - event.request.headers.referer
      sourceType: attribute
      target: http.referer
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.request.headers.host` to `http.url_details.host`"
      enabled: true
      sources:
        - event.request.headers.host
      sourceType: attribute
      target: http.url_details.host
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.request.headers` to `http.request.headers`"
      enabled: true
      sources:
        - event.request.headers
      sourceType: attribute
      target: http.request.headers
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.request.headers.user-agent` to `http.user-agent`"
      enabled: true
      sources:
        - event.request.headers.user-agent
      sourceType: attribute
      target: http.user-agent
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.rule` to `evt.name`"
      enabled: true
      sources:
        - event.rule
      sourceType: attribute
      target: evt.name
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.host.operatingSystem` to `http.useragent_details.os.family`"
      enabled: true
      sources:
        - event.host.operatingSystem
      sourceType: attribute
      target: http.useragent_details.os.family
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.host.hostname` to `network.host.name`"
      enabled: true
      sources:
        - event.host.hostname
      sourceType: attribute
      target: network.host.name
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
    - type: attribute-remapper
      name: "Map `event.agentVersion` to `version`"
      enabled: true
      sources:
        - event.agentVersion
      sourceType: attribute
      target: version
      targetType: attribute
      preserveSource: true
      overrideOnConflict: false
