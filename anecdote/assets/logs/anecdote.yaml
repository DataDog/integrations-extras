id: anecdote
metric_id: anecdote
backend_only: true
pipeline:
  type: pipeline
  name: Anecdote Log Pipeline
  enabled: true
  filter:
    query: "source:anecdote"
  processors:
    processors:
      - type: grok-parser
        grok:
          match_rules:
            - '"%{TIMESTAMP_ISO8601:content.timestamp} %{WORD:service} %{GREEDYDATA:message}"'
      - type: log-date-remapper
        sources:
          - content.timestamp
      - type: service-remapper
        source: content.service
      - type: attribute-remapper
        sources:
          - id
        target: log_id
      - type: attribute-remapper
        sources:
          - content.attributes.date
        target: log_date
      - type: attribute-remapper
        sources:
          - content.tags
        target: tags
        target_type: array
      - type: attribute-remapper
        sources:
          - content.attributes.service
        target: service_name
      - type: attribute-remapper
        sources:
          - content.attributes.tags
        target: additional_tags
        target_type: array
      - type: status-remapper
        sources:
          - content.attributes.is_feedback_bug
      - type: add-tags
        tags:
          - environment:production
          - team:anecdote
          - source:anecdote
